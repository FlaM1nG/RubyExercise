{% extends '::base.html.twig' %}
{% import 'macros/alert.html.twig' as alerts %}

{% block header %}
    {{ parent() }}
    {{ include('nav/menu.html.twig') }}
{% endblock %}

{% block alert %}

{% endblock %}

{% block body %}
  {{form_start(form)}}
    <div class="container cd-main-content">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <h2>Confirmación datos de pago</h2>
                <hr/>
            </div>
        </div>

        <div class="cont-pago">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 separacion-inferior">
                    <h4>Dirección</h4>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12">
                    <div class="form-group">
                        {{form_row(form.addressPay)}}
                    </div>
                </div>

                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                    <div class="form-group">
                        <label class="form-cien">&nbsp;</label>
                        <a href="#" class="btn btn-default btn-normal">
                            Nueva dirección
                        </a>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 separacion-inferior">
                    <label class="checkbox-inline">
                        {{form_widget(form.facture)}}  
                      
                    </label>
                </div>
            </div>

            <div class="row row-facturacion hidden">
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                    <div class="form-group">
                        {{form_row(form.dirFac)}}
                    </div>
                </div>

                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <div class="form-group">
                            <label for="usr">DNI/NIF</label>
                            {{form_widget(form.dni)}}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="cont-pago">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 separacion-inferior">
                    <h4>Método de pago</h4>
                </div>
            </div>

            <div class="row row-payment-method">
                <div class="us-check-group-element col-lg-6 col-md-6 col-sm-6 col-xs-6">
                    <label class="check-payment-method center-block" title="Paypal">
                        <img class="img-responsive center-block img-metodo-pago" src="{{ asset('img/paypal.png') }}" />
                        {{form_widget(form.paypal)}}
                    </label>

                    {#<span class="us-register-text-hobby">#}
                    {#Paypal#}
                    {#</span>#}
                </div>

                <div class="us-check-group-element col-lg-6 col-md-6 col-sm-6 col-xs-6">
                    <label class="check-payment-method center-block" title="Tarjeta">
                        <img class="img-responsive center-block img-metodo-pago" src="{{ asset('img/tarjetas3.jpg') }}" />
                        {{form_widget(form.card)}}
                    </label>

                    {#<span class="us-register-text-hobby">#}
                    {#Tarjeta#}
                    {#</span>#}
                </div>
            </div>
        </div>

        <div class="cont-pago">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 separacion-inferior">
                    <h4>Método de envio</h4>
                </div>
            </div>

            <div class="row row-send-method">
                <div class="us-check-group-element col-lg-4 col-md-4 col-sm-4 col-xs-12">
                    <label class="check-send-method center-block" title="Correos">
                        <img class="img-responsive center-block img-metodo-envio" src="{{ asset('img/correos.jpg') }}" />
                        {{form_widget(form.correos)}}
                    </label>

                    {#<span class="us-register-text-hobby">#}
                    {#Correos#}
                    {#</span>#}
                </div>

                <div class="us-check-group-element col-lg-4 col-md-4 col-sm-4 col-xs-12">
                    <label class="check-send-method center-block" title="DHL">
                        <img class="img-responsive center-block img-metodo-envio" src="{{ asset('img/dhl.png') }}" />
                        {{form_widget(form.dhl)}}
                    </label>

                    {#<span class="us-register-text-hobby">#}
                    {#DHL#}
                    {#</span>#}
                </div>

                <div class="us-check-group-element col-lg-4 col-md-4 col-sm-4 col-xs-12">
                    <label class="check-send-method center-block" title="Otros">
                        <img class="img-responsive center-block img-metodo-envio" src="{{ asset('img/otro.png') }}" />
                        {{form_widget(form.otros)}}
                    </label>

                    {#<span class="us-register-text-hobby">#}
                    {#Otros#}
                    {#</span>#}
                </div>
            </div>
        </div>


        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">
                <h4>Total</h4>
                <h4>{{ offer.price|number_format(2, ',') }} €</h4>
                {{form_row(form.submit, {'id': 'pagar_ofertas'})}}
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <table class="table table-striped table-pago">
                    <thead>
                        <tr>
                            <th>{{ offer.offer.title }}</th>
                            <th class="text-right">{{ offer.price|number_format(2, ',') }} €</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Gastos de envío</td>
                            <td class="text-right">Precio</td>
                        </tr>
                        <tr>
                            <td>%IVA</td>
                            <td class="text-right">Precio</td>
                        </tr>
                        <tr class="table-pago-total">
                            <th></th>
                            <th>Precio Total</th>
                        </tr>
                        <tr class="table-pago-total">
                            <td></td>
                            <td>{{ offer.price|number_format(2, ',') }} €</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>



    </div>
{% endblock %}

{% block javascriptsFooter %}
    {{ parent() }}

    {{ include('nav/menuScript.html.twig') }}

    <script type="text/javascript">
        $(document).ready(function () {

            {# Funcionalidad para mostrar o no para realizar factura. #}
            $('.check-facturacion').on('click', function () {
                $('.row-facturacion').toggleClass('hidden');
            });

            {# Funcionalidad para elegir método de pago #}
            $('.check-payment-method').on('click', '.img-metodo-pago', function () {
                var elegido = $('.row-payment-method').find('.check-payment-method-checked');

                if($(elegido)){
                    $(elegido).toggleClass('check-payment-method-checked');
                }

                $(this).parent().toggleClass('check-payment-method-checked');
            });


            {# Funcionalidad para elegir método de envio #}
            $('.check-send-method').on('click', '.img-metodo-envio', function () {
                var elegido = $('.row-send-method').find('.check-send-method-checked');

                if($(elegido)){
                    $(elegido).toggleClass('check-send-method-checked');
                }

                $(this).parent().toggleClass('check-send-method-checked');
            });

            {# Validación de datos para pago #}
            {#$('#pagar_ofertas').on('click', function () {#}
                {#var alerta;#}
                {#var mensaje = "- Vacio";#}

                {# Comprueba de la dirección de envio no sea nula #}
                {#if($('#dir_envio').val() == null | $('#dir_envio').val() == 'null'){#}
                    {#console.log('VACIO');#}
                {#}#}

                {#mensaje = mensaje.concat("\n- LLENO");#}

                {#if($('.alert-zone').length != 0){#}
                    {#console.log($('.alert-zone'));#}
                    {#$('.alert-zone').text(mensaje);#}
                    {#$('.alert-zone').text().replace(/\n/g,'<br/>');#}
                {#}else{#}
                    {#alerta = `{% spaceless %}{{ alerts.alert('alert-danger alert-zone', 'Vacio') }}{% endspaceless %}`;#}
                    {#$('#blockAlert').html(alerta);#}
                {#}#}


            {#});#}

        });
    </script>
{% endblock %}

{% block footer %}
    {{ include('footer/sponsorFooter.html.twig') }}
    {{ parent() }}
{% endblock %}
