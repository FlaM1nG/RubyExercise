{% extends 'UserBundle:Layouts:layoutProfile.html.twig' %}
{% import 'macros/script.html.twig' as codMenu %}


{% block title %}
    Casas
{% endblock %}

{% block alertProfile %}

    {% for flash_message in app.session.flashbag.get('messageSuccess') %}
        {{ alerts.alert('alert-success', flash_message, null) }}
    {% endfor %}

    {% for flash_message in app.session.flashbag.get('messageFail') %}
        {{ alerts.alert('alert-warning', flash_message, null) }}
    {% endfor %}


{% endblock %}


{% block javascriptsHeader %}
    {{ parent() }}
{% endblock %}


{% block bodyProfile %}
    <div class="row us-dataPersonal-row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h3>
                Agregar una nueva casa
            </h3>
            <hr/>
            {#{{ form(form) }}#}
            {{ form_start(form) }}

            {{ form_row(form.address.country) }}
            {{ form_row(form.address.city) }}
            {{ form_row(form.address.street) }}
            {{ form_row(form.address.zipCode) }}

            {% for row in form.children if row.vars.name!='address' %}
                    {{ form_row(row) }}
            {% endfor %}
            {#<input id="imgHouse" name="imgHouse[]" type="file" multiple class="file-loading" accept="image/*" required >#}

        </div>
    </div>
{% endblock %}



{% block javascriptsFooter %}
    {{ parent() }}
    {{ codMenu.scriptUserMenu('.us-dataPersonal-row') }}

    <!-- the main fileinput plugin file -->
    <script src="{{ asset('js/fileinput.js') }}"></script>
    <script src="{{ asset('js/locales/es.js') }}"></script>

    <script type="text/javascript">

        {% set arrayUrl = "" %}
        {% set arrayCaption = "" %}

        {% for house in house.photos %}

        {% set arrayUrl = arrayUrl~"'"~asset(house.url,'img')~"'," %}
        {% set arrayCaption = arrayCaption~"{caption: '', width: '120px', showZoom: false, key: "~house.id|number_format~" ,extra: {id: "~house.id~" }}," %}

        {% endfor %}


        $(document).ready(function(){

            $(".file-loading").fileinput({
                initialPreview: [
                    {{arrayUrl|raw}}
                ],
                initialPreviewConfig: [
                    {{arrayCaption|raw}}
                ],
                initialPreviewAsData: true,
                overwriteInitial: false,
                maxFileSize: 3072,
                showRemove: false,
                showUpload: false,
                showZoom: false,
                initialCaption: '',
                language: "es",
                validateInitialCount: true,
                allowedFileExtensions: ["jpg", "jpeg", "png"],
                minFileCount:1,
                maxFileCount: 50,
                extra: {idHouse: {{ house.id }} }
            });
        });
    </script>

{% endblock %}

