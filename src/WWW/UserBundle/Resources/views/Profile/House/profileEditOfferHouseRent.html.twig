{% extends 'UserBundle:Layouts:layoutProfile.html.twig' %}
{% import 'macros/script.html.twig' as codMenu %}

{% block stylesheets %}
    {{ parent() }}

    {% if service != 8 %}

        <link rel="stylesheet" href="{{ asset('css/calendario/fullcalendar.css') }}" />

    {% endif %}

{% endblock %}


{% block title %}
    Ofertas
{% endblock %}

{% block alertProfile %}

    {% for flash_message in app.session.flashbag.get('messageSuccess') %}
        {{ alerts.alert('alert-success', flash_message, null) }}
    {% endfor %}

    {% for flash_message in app.session.flashbag.get('messageFail') %}
        {{ alerts.alert('alert-warning', flash_message, null) }}
    {% endfor %}

    {{ form_errors(form) }}
{% endblock %}


{% block javascriptsHeader %}
    {{ parent() }}
{% endblock %}

{% set title = "" %}

{% if service == 6 %}
    {% set title = "Editar oferta de alquiler turístico" %}

{% elseif service == 7 %}
    {% set title = "Editar oferta de casa compartida" %}

{% elseif service == 8 %}
    {% set title = "Editar oferta de intercambio de casas" %}
{% endif %}

{% block bodyProfile %}

    <div class="row us-dataPersonal-row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h3>
                {{title}}
            </h3>
            <hr/>

            {{ form_start(form) }}

            <div class="form-group">
                <label class="control-label">Casa</label>
                <a href="{{ path('user_profile_editHouse',{idHouse: offer.house.id}) }}" class="linkBlock">Ir a editar la casa asociada</a>
            </div>

            {{ form_row(form.houseId) }}
            {{ form_row(form.offer.title) }}
            {{ form_row(form.offer.description) }}

            {% if service != 8 %}
                <div class="us-price-special">
                    {{ form_row(form.price) }}
                </div>

                <div class="form-group">
                    <div class="">
                        {{ form_label(form.entryTime) }}
                        {{ form_widget(form.entryTime) }}
                    </div>
                    <div>
                        {{ form_label(form.departureTime) }}
                        {{ form_widget(form.departureTime) }}
                    </div>
                </div>

            {% endif %}

            {{ form_row(form.offer.id) }}
            {{ form_row(form._token) }}



            {% if service != 8 %}
                <div class="container">

                    <div class="row">
                        <div class="col-lg-8 text-center">
                            <h3>Calendario</h3>
                            <p class="lead">Para editar el precio pulsar dos veces sobre el precio que se desee modificar</p>
                            <div id="calendar-holder" class="col-centered us-calendar">
                            </div>
                        </div>
                        <div class="col-lg-8 text-left">
                            <br>
                            <p class="lead" style="color:#008000;">&#9724; Días Libres</p>
                            <p class="lead" style="color:#FF0000;">&#9724; Días Ocupados</p>
                            <p class="lead" style="color:#151515;">&#9724; Días Bloqueados</p>
                        </div>

                    </div>

                    <!-- Formulario editar precio calendario -->
                    <div class="modal fade" id="ModalEdit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <form class="form-horizontal" method="POST" action="{{ path('fullcalendar_edit_create') }}">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                        <h4 class="modal-title" id="myModalLabel">Editar Precio</h4>
                                    </div>
                                    <div class="modal-body">
                                        <div class="form-group">
                                            <label for="price" class="col-sm-2 control-label">Precio</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="price" class="form-control" id="price">
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label for="blocked" class="col-sm-2 control-label">Bloquear</label>
                                            <div class="col-sm-10">
                                                <select name="blocked" class="form-control" id="blocked">
                                                    <option value="0">No</option>
                                                    <option value="1">Sí</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label for="id" class="col-sm-2 control-label"></label>
                                            <div class="col-sm-10">
                                                <input type="hidden" name="id" class="form-control" id="id">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="calendar_id" class="col-sm-2 control-label"></label>
                                            <div class="col-sm-10">
                                                <input type="hidden" name="calendar_id" class="form-control" id="calendar_id">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="service_id" class="col-sm-2 control-label"></label>
                                            <div class="col-sm-10">
                                                <input type="hidden" name="service_id" class="form-control" id="service_id">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="start" class="col-sm-2 control-label"></label>
                                            <div class="col-sm-10">
                                                <input type="hidden" name="start" class="form-control" id="start">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="end" class="col-sm-2 control-label"></label>
                                            <div class="col-sm-10">
                                                <input type="hidden" name="end" class="form-control" id="end">
                                            </div>
                                        </div>

                                        <input type="hidden" name="id" class="form-control" id="id">
                                        <input type="hidden" name="title" class="form-control" id="title">
                                        <input type="hidden" name="serviceID" class="form-control" id="serviceID" value="{{ service }}">
                                        <input type="hidden" name="calendarID" class="form-control" id="calendarID" value="{{ calendarID }}">
                                        <input type="hidden" name="startDateCalendario" class="form-control" id="startDateCalendario" value="">


                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default btn-cal-pop" data-dismiss="modal">Cerrar</button>
                                        <button type="submit" class="btn btn-default btn-cal-pop">Guardar Cambios</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                </div>
                {% include 'ADesignsCalendarBundle::calendar.html.twig' %}

            {% endif %}

            {{ form_row(form.newShareHouse) }}
        </div>
    </div>

{% endblock %}


{% block javascriptsFooter %}
    {{ parent() }}
    {{ codMenu.scriptUserMenu('.us-dataPersonal-row') }}

    <script src="{{ asset('js/plugins/canvas-to-blob.min.js') }}"
            type="text/javascript"></script>
    <!-- sortable.min.js is only needed if you wish to sort / rearrange files in initial preview.
         This must be loaded before fileinput.min.js -->
    <script src="{{ asset('js/plugins/sortable.js') }}"
            type="text/javascript"></script>
    <!-- purify.min.js is only needed if you wish to purify HTML content in your preview for HTML files.
         This must be loaded before fileinput.min.js -->
    <script src="{{ asset('js/plugins/purify.min.js') }}"
            type="text/javascript"></script>


    {% if service != 8 %}
        <!-- Calendario -->

        <script type="text/javascript" src="{{ asset('js/calendario/jquery-2.1.1.min.js') }}"></script>
        <script type="text/javascript" src="{{ asset('js/calendario/jquery-ui.custom.min.js') }}"></script>
        <script type="text/javascript" src="{{ asset('js/calendario/moment.min.js') }}"></script>
        <script type="text/javascript" src="{{ asset('js/calendario/fullcalendar.min.js') }}"></script>
        <script type="text/javascript" src="{{ asset('js/calendario/fullcalendar-lang-all.js') }}"></script>
        <script type="text/javascript" src="{{ asset('js/calendario/prueba/calendario.js') }}"></script>
        <script type="text/javascript" src="{{ asset('js/bootstrap.min.js') }}"></script>

        <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
        <script src="{{ path('fos_js_routing_js', {"callback": "fos.Router.setData"}) }}"></script>

    {% endif %}

{% endblock %}

