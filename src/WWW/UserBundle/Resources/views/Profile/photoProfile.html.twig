{% extends 'UserBundle:Layouts:layoutProfile.html.twig' %}
{% import 'macros/script.html.twig' as codMenu %}

{% block stylesheets %}
    
    {{ parent() }}
            
    {#<link href="{{ asset('css/styles/imgAreaSelect/imgareaselect-default.css') }}" rel="stylesheet" #}
                  {#type="text/css">#}

<style>
    .kv-avatar .file-preview-frame,.kv-avatar .file-preview-frame:hover {
        margin: 0;
        padding: 0;
        border: none;
        box-shadow: none;
        text-align: center;
    }
    .kv-avatar .file-input {
        display: table-cell;
        max-width: 220px;
    }
</style>

{% endblock %}

{% block title %}
    Foto de Perfil
{% endblock %}

{% block alertProfile %}
    
    {% for flash_message in app.session.flashbag.get('messageSuccess') %}
            {{ alerts.alert('alert-success', flash_message, null) }}
        {% endfor %} 

        {% for flash_message in app.session.flashbag.get('messageFail') %}
            {{ alerts.alert('alert-warning', flash_message, null) }}
    {% endfor %}

    {#{{ form_errors(form) }}#}
   
{% endblock %} 


{% block javascriptsHeader %}
    {{ parent() }}
{% endblock %}


{% block bodyProfile %}

    <div class="row us-dataPersonal-row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h3>
                Cambiar Imagen Personal
            </h3>
            <hr/>

            {#{{ form_start(form) }}#}

    {#<img src="{{ asset(form.photo.url.vars.value|default('web/img/userDefault.png'),'img') }}" id="photo"/>#}
        {#{{ form_row(form._token) }}#}
        {#{{ form_row(form.savePhoto)}}#}

        {#<input type="hidden" name="x1" value="" />#}
        {#<input type="hidden" name="y1" value="" />#}
        {#<input type="hidden" name="x2" value="" />#}
        {#<input type="hidden" name="y2" value="" />#}
        {#<input type="submit" name="submit" value="Submit" />#}

            {#<input id="imgProfile" name="imgProfile" type="file" accept="image/*" class="file-loading">#}
        <form action="{{ path('user_profilePhoto') }}" method="post" enctype="multipart/form-data" id="formPhotoProfile" name ="formPhotoProfile">
            <div id="kv-avatar-errors-1" class="center-block" style="width:800px;display:none"></div>
            <div class="kv-avatar center-block" style="width:200px">
                <input id="avatar" name="avatar" type="file" accept="image/*" class="file-loading">
            </div>
        </form>

{% endblock %}



{% block javascriptsFooter %}
    {{ parent() }}

    {{ codMenu.scriptUserMenu('.us-dataPersonal-row') }}
   
    {#<script src="{{ asset('js/selectArea/jquery.imgareaselect.pack.js') }}"></script>#}
    {#<script type="text/javascript">#}
        {#$(document).ready(function () {#}
            {##}
             {#$('#photo').imgAreaSelect({#}
                 {#x1: 0,#}
                 {#y1: 0,#}
                 {#x2: 300,#}
                 {#y2: 300,#}
                 {#hide: false,#}
                 {#maxWidth: 300,#}
                 {#maxHeight: 300,#}
                 {#minWidth: 300,#}
                 {#minHeight: 300,#}
                 {#resizable: false,#}
             {#});#}
        {#});#}
    {#</script>#}

    <script src="{{ asset('js/fileinput.js') }}"></script>

    <script type="text/javascript">


        var btnCust = '<button type="button" class="btn btn-default btn-fileinput-save" title="Guardar" ' +
                        'onclick="document.formPhotoProfile.submit()">' +
                        '<i class="glyphicon glyphicon-floppy-disk"></i>' +
                        '</button>';

        var aux  = '{{ user.photo.url }}';
        var img = '{{ asset('web/img/userDefault','img') }}';

        if(aux != ''){
            var img = '{{ asset(user.photo.url,'img') }}';
        }

        $("#avatar").fileinput({
            overwriteInitial: true,
            maxFileSize: 3500,
            showClose: false,
            showCaption: false,
            browseLabel: '',
            removeLabel: '',
            browseIcon: '<i class="glyphicon glyphicon-folder-open"></i>',
            removeIcon: '<i class="glyphicon glyphicon-remove"></i>',
            removeTitle: 'Cancelar o resetear cambios',
            elErrorContainer: '#kv-avatar-errors-1',
            msgErrorClass: 'alert alert-block alert-danger',
            defaultPreviewContent: '<img src="'+img+'" alt="Your Avatar" style="width:160px">',
            layoutTemplates: {main2: '{preview}'+btnCust+'{browse}{remove}'},

        });
    </script>


{% endblock %}