{% extends 'UserBundle:Layouts:layoutProfile.html.twig' %}
{% import 'macros/script.html.twig' as codMenu %}


{% block title %}
    Coches
{% endblock %}

{% block alertProfile %}

    {% for flash_message in app.session.flashbag.get('messageSuccess') %}
        {{ alerts.alert('alert-success', flash_message, null) }}
    {% endfor %}

    {% for flash_message in app.session.flashbag.get('messageFail') %}
        {{ alerts.alert('alert-warning', flash_message, null) }}
    {% endfor %}


{% endblock %}


{% block javascriptsHeader %}
    {{ parent() }}
{% endblock %}


{% block bodyProfile %}
    <div class="row us-dataPersonal-row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h3>
                Agregar un nuevo coche
            </h3>
            <hr/>

{#{{ dump(form) }}#}
    <form action="{{ path('user_profileNewCar') }}" method="post" {{ form_enctype(form) }}>
        {{ form_row(form.brand) }}
        {{ form_row(form.model) }}
        {{ form_row(form.type) }}
        {{ form_row(form.plate)}}
        {{ form_row(form.color) }}
        {{ form_row(form.description) }}
        {{ form_row(form.seats) }}
        {{ form_row(form.smoke) }}
        {{ form_row(form.animals) }}
        {{ form_row(form.music) }}
        {{ form_row(form.talk) }}
        {{ form_row(form._token) }}
        <input id="imgCar" name="imgCar[]" type="file" multiple class="file-loading" accept="image/*" required >
        {{ form_row(form.saveNewCar) }}

        </div>
    </div>
{% endblock %}



{% block javascriptsFooter %}
    {{ parent() }}
    {{ codMenu.scriptUserMenu('.us-dataPersonal-row') }}

    <!-- the main fileinput plugin file -->
    <script src="{{ asset('js/fileinput.js') }}"></script>

    <script type="text/javascript">
            brand = $('#newCar_brand');
            models = $('#newCar_model').clone();

            brandSelected = $('#newCar_brand option:selected').text();

            var options =  models.find('optgroup[label="'+brandSelected+'"]').html();

            $('#newCar_model').find('optgroup').remove();
            $('#newCar_model').append(options);

        $(document).ready(function(){

            $(document).on('change','#newCar_brand',changeModel);

            function changeModel(){

                var marca = $('#newCar_brand option:selected').text();
                var options =  models.find('optgroup[label="'+marca+'"]').html();

                $('#newCar_model').find('option').remove();
                $('#newCar_model').append(options);

            }

            $(".file-loading").fileinput({

                initialPreviewAsData: true,
                overwriteInitial: false,
                maxFileSize: 3072,
                showRemove: false,
                showUpload: false,
                showZoom: false,
                initialCaption: '',
                maxFileCount: 5,

            });
        });
    </script>

{% endblock %}

