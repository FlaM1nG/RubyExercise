{% extends '::base.html.twig' %}
{% import 'macros/alert.html.twig' as alerts %}


{% block title %}
    Profile
{% endblock %}

{% block nav %}
    {{ parent() }}
    {{ include('nav/menu.html.twig') }}
{% endblock %}

{% block alert %}
    
{% endblock %} 


{% block javascriptsHeader %}
    {{ parent() }}
    {#<script src="{{ asset('js/plugins/canvas-to-blob.min.js') }}" 
        type="text/javascript"></script>
    <!-- sortable.min.js is only needed if you wish to sort / rearrange files in initial preview.
         This must be loaded before fileinput.min.js -->
    <script src="{{ asset('js/plugins/sortable.js') }}" 
        type="text/javascript"></script>
    <!-- purify.min.js is only needed if you wish to purify HTML content in your preview for HTML files.
         This must be loaded before fileinput.min.js -->
    <script src="{{ asset('js/plugins/purify.min.js') }}" 
        type="text/javascript"></script>
    <!-- the main fileinput plugin file -->
    <script src="{{ asset('js/fileinput.min.js') }}"></script>

    <!-- optionally if you need translation for your language then include 
        locale file as mentioned below -->
    <script src="{{ asset('js/locales/es.js') }}"></script>#}
{% endblock %}
      



{% block body %}
    
<!-- TABULADOR DE PESTAÑAS -->
<div class="container-fluid cd-main-content us-profile-panel">
    <div class="row">
        <header class="cd-main-header">
            {#<a href="#0" class="cd-logo"><img src="img/cd-logo.svg" alt="Logo"></a>

            <div class="cd-search is-hidden">
                <form action="#0">
                    <input type="search" placeholder="Search...">
                </form>
            </div> <!-- cd-search -->#}

            <a href="#0" class="cd-nav-trigger">Menu<span></span></a>

            <nav class="cd-nav">
                {#<ul class="cd-top-nav">
                    <li><a href="#0">Tour</a></li>
                    <li><a href="#0">Support</a></li>
                    <li class="has-children account">
                        <a href="#0">
                            <img src="img/cd-avatar.png" alt="avatar">
                            Account
                        </a>

                        <ul>

                            <li><a href="#0">My Account</a></li>
                            <li><a href="#0">Edit Account</a></li>
                            <li><a href="#0">Logout</a></li>
                        </ul>
                    </li>
                </ul>#}
            </nav>
        </header> <!-- .cd-main-header -->
        <main class="cd-main-content us-content-user">
            <nav class="cd-side-nav">
                <ul>
                    {#<li class="cd-label">Personal</li>#}
                    <li class="has-children misDatos">
                        {#<i class="fa fa-user" aria-hidden="true"></i>#}
                        <a href="#0">Mis datos</a>  

                        <ul>
                            <li><a href="#0">Email</a></li>
                            <li><a href="#0">Contraseña</a></li>
                            <li><a href="#0">Teléfono</a></li>
                            <li><a href="#0">Foto Personal</a></li>
                        </ul>
                    </li>
                    <li class="addressUser">
                        <a href="#0">Direcciones</a>
                    </li>
                    <li class="has-children comments active">
                        <a href="#0">Mensajes<span class="count">3</span></a>

                        <ul>
                            <li><a href="#0">Redactar</a></li>
                            <li><a href="#0">Recibidos</a></li>
                            <li><a href="#0">Enviados</a></li>
                        </ul>
                    </li>
                    
                    {% for i in 0..10 %}
                    <li class="has-children offerUser">
                        <a href="#0">Ofertas</a>

                        <ul>
                            <li><a href="#0">Mis ofertas</a></li>
                            <li><a href="#0">Compras</a></li>
                            <li><a href="#0">Inscripciones</a></li>
                        </ul>
                    </li>
                    {% endfor %}
                    
                </ul>
            </nav>

            <div class="content-wrapper">
{#                <div class="container">#}
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <h1>Responsive Sidebar Navigation</h1>
                            <p>{{ include('macros/text.html.twig') }}</p>
                        </div>
                    </div>
{#                    <h1>Responsive Sidebar Navigation</h1>#}
{#                </div>#}
            </div> <!-- .content-wrapper -->
        </main> <!-- .cd-main-content -->
    </div>
                
</div>

{% endblock %}

{% block javascriptsFooter %}
    {{ parent() }}
    <script>
        
    </script>
    <script src="{{ asset('js/jquery.menu-aim.js') }}"></script>
    <script src="{{ asset('js/mainUserMenu.js') }}"></script> <!-- Resource jQuery -->
    
    <script>
        $('#myTabs a').click(function (e) {
            e.preventDefault();
            $(this).tab('show');
        });
    </script>
    
    <script type="text/javascript">
    $(document).scroll(function(e){
        var scrollTop = $(document).scrollTop();
        if(scrollTop > $('#menuAdministracion').height()){
            //console.log(scrollTop);
            $('#cbp-hrmenu').css("position","fixed");
            $('#cbp-hrmenu').css("top","0");
            $('#cbp-hrmenu').css("z-index","999");
        } else {
            $('#cbp-hrmenu').css("position","relative");
        }
    });
    
    </script>
    
    <script type="text/javascript">
        //Previsualización de las imágenes
        function archivo(evt) { 
                  var files = evt.target.files; // FileList object
             
                  // Obtenemos la imagen del campo "file".
                  for (var i = 0 ; i< files.length; i++) {
                        var f = files[i];
             
                    var reader = new FileReader();
             
                    reader.onload = (function(theFile) {
                        return function(e) {
                          // Insertamos la imagen
                         document.getElementById("profileImage").innerHTML = ['<img height="100" widht="100" src="', e.target.result,'" title="', escape(theFile.name), '"/>'].join('');
                        };
                    })(f);
             
                    reader.readAsDataURL(f);
                  }
              }
             
{#              document.getElementById('profilePhoto_fileImage').addEventListener('change', archivo, false);#}

    </script>
    
    <script type="text/javascript">


        $(document).ready(function() {
            
            var $collectionHolder;

            // setup an "add a tag" link
            var $addTagLink = $('<button class="add_tag_link">Nueva Dirección</button>');
            var $newLinkLi = $('<li></li>').append($addTagLink);

            jQuery(document).ready(function() {
                // Get the ul that holds the collection of tags
                $collectionHolder = $('ul.newAddress');

                // add the "add a tag" anchor and li to the tags ul
                $collectionHolder.append($newLinkLi);

                // count the current form inputs we have (e.g. 2), use that as the new
                // index when inserting a new item (e.g. 2)
                $collectionHolder.data('index', $collectionHolder.find(':input').length);

                $addTagLink.on('click', function(e) {
                    // prevent the link from creating a "#" on the URL
                    e.preventDefault();

                    // add a new tag form (see next code block)
                    addTagForm($collectionHolder, $newLinkLi);
                    
                    $('#profileAddress_deleteAddresses').css('display','none');
                    //Solo se permite añadir una dirección de una vez, 
                    //así que ocultamos el botón
                    $('.add_tag_link').css('display','none');
                    //Mostramos el botón de guardar una dirección nueva
                    $('#profileAddress_addAddress').css('display','block');
                });
            });
            
            function addTagForm($collectionHolder, $newLinkLi) {
                // Get the data-prototype explained earlier
                var prototype = $collectionHolder.data('prototype');

                // get the new index
                var index = $collectionHolder.data('index');

                // Replace '__name__' in the prototype's HTML to
                // instead be a number based on how many items we have
                var newForm = prototype.replace(/__name__/g, index);

                // increase the index with one for the next item
                $collectionHolder.data('index', index + 1);

                // Display the form in the page in an li, before the "Add a tag" link li
                var $newFormLi = $('<li></li>').append(newForm);
                $newLinkLi.before($newFormLi);
                
            }
           
            
            //$(document).on('click','.checkDeleteAddress', deleteAddresses);
            $(document).on('click','.add_tag_link',showHiddenButtonAdd);
            $(document).on('click','.newMessageButton', showFormNewMessage);
            $(document).on('click','.buttonDeleteMessage', deleteMessage);
            
            
            
            function deleteMessage(e){
                e.stopPropagation();
                //e.preventDefault();
                var arrayName = $(this).attr('id').split('_');
                var posArray = arrayName[2];
                var typeMessage = arrayName[1];
                
                $('#profileMessage_idRemove').val(posArray);
                $('#profileMessage_fromTo').val(typeMessage);
            }
            
            function showFormNewMessage(e){
                e.preventDefault();
                
                if($('.containeMessages').is(':visible')){
                    $('.containeMessages').hide();
                    $('#message_to, #message_message').attr('required',true);
                    $('.newMessage').show();
                    
                }else{
                    
                    $('.containeMessages').show();
                    $('#message_to, #message_message').attr('required',false);
                    $('.newMessage').hide();
                }
            }
            
            function editAddress(e){
                e.preventDefault();
                
                $('.dataAddress').css('display','none');
                $(this).parent().next().css('display','block');
                $('.add_tag_link').css('display','none');
                $('.editAddress').css('display','block');
                $('#profileUser_deleteAddresses').css('display','none');
            }
            
            function showHiddenButtonAdd(e){
                
            }
        });


    </script>
 
    <script type="text/javascript" src="{{ asset('js/profile.js') }}">  </script>
    
    
    <script src="{{ asset('js/plugins/canvas-to-blob.min.js') }}" 
        type="text/javascript"></script>
    <!-- sortable.min.js is only needed if you wish to sort / rearrange files in initial preview.
         This must be loaded before fileinput.min.js -->
    <script src="{{ asset('js/plugins/sortable.js') }}" 
        type="text/javascript"></script>
    <!-- purify.min.js is only needed if you wish to purify HTML content in your preview for HTML files.
         This must be loaded before fileinput.min.js -->
    <script src="{{ asset('js/plugins/purify.min.js') }}" 
        type="text/javascript"></script>
    <!-- the main fileinput plugin file -->
    <script src="{{ asset('js/fileinput.js') }}"></script>

    <!-- optionally if you need translation for your language then include 
        locale file as mentioned below -->
    <script src="{{ asset('js/locales/es.js') }}"></script>
    
    <script>
        $(document).ready(function(){
            $("#profileUser_fileImage").fileinput({
                showUpload: false, 
                previewFileType: 'image',
                initialPreview: [
                    'http://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/FullMoon2010.jpg/631px-FullMoon2010.jpg',
                    'http://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Earth_Eastern_Hemisphere.jpg/600px-Earth_Eastern_Hemisphere.jpg'
                ],
                initialPreviewAsData: true,
                initialPreviewConfig: [
                    {caption: "Moon.jpg", size: 930321, width: "120px", key: 1},
                    {caption: "Earth.jpg", size: 1218822, width: "120px", key: 2}
                ],
                deleteUrl: "/site/file-delete",
                overwriteInitial: false,
                maxFileSize: 100,
                initialCaption: "Selecciona tu imagen de perfil"
            });
        });
    </script>
    
    {#<script>
        $(function () {
            $('.navbar-toggler').on('click', function(event) {
                event.preventDefault();
                $(this).closest('.navbar-minimal').toggleClass('open');
            });
        });
    </script>#}
    
{% endblock %}
